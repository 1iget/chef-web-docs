---
title: 'Set up Chef server and a node to manage'
meta_tags: [{name: "ROBOTS", content: "NOINDEX, NOFOLLOW"}]
description: 'Sign up for hosted Chef and set up your workstation to communicate with the Chef server.'
order: 2
layout: tutorials/platforms/environments/overview/lesson/layout
time_to_complete: 20 minutes
snippet_path: manage-a-node/rhel/virtualbox/set-up-your-chef-server
snippet_workstation: ubuntu
headings: [
  { label: '1. Understand prerequisites', href: '#step1' },
  { label: '2. Run the Vagrantfile', href: '#step2' },
  { label: '3. Configure your workstation', href: '#step3' },
  ]
---
[HEADLINE] Chef server acts as a central repository for your cookbooks as well as for information about every node it manages.<br>The `knife` command enables you to communicate with the Chef server from your workstation.

Recall that there are two ways to work with a Chef server.

1. Install Chef server on your own infrastructure.
2. Sign up for hosted Chef, a Chef server that we manage for you.

Although Chef server is typically run in a long-lasting environment, bringing one up in a local virtual machine environment is a great way to learn how it works. Here you'll bring up Chef server and a CentOS node to manage using Vagrant and VirtualBox.

In production, the decision to use hosted Chef or manage your own Chef server depends on your organization's requirements and preferences.

Although this option helps you set up a Chef server and a node to manage more quickly, you'll later want to set up a dedicated Chef server for your team to use. After you complete this tutorial, consider [working through one of the other options](/tutorials/manage-a-node/rhel/) to set up Chef server in an environment that more closely matches your team's requirements.

[START_BOX]

## 1. Understand prerequisites

Running local virtual machines requires relatively powerful hardware. Before you begin, ensure that:

* your workstation supports and is configured to use CPU virtualization. This setting is typically configured through your system's BIOS.
* your workstation meets the [system requirements](https://www.virtualbox.org/wiki/End-user_documentation)  for running VirtualBox.
* your workstation has at least 15GB of free disk space. This will enable you to download the base images and run a few virtual machine instances.
* your workstation has at least 4GB of available memory.
* nested virtualization is enabled if you're using another virtual machine as your workstation through a program such as VMWare Fusion.

If you're new to Vagrant and VirtualBox, [the previous Learn Chef tutorial](/tutorials/learn-the-basics/rhel/virtualbox/set-up-a-machine-to-manage/) can help you get set up. You can follow the steps that have you bring up a CentOS instance to verify the installation. However, you don't need to connect to or install the Chef DK on your CentOS instance.

[END_BOX]

[START_BOX]

## 2. Run the Vagrantfile

In this part, you'll run a [Vagrantfile](https://www.vagrantup.com/docs/vagrantfile/) to bring up Chef server and a CentOS node to manage.

Start by creating a directory to hold your <% fp 'Vagrantfile' %> and your virtual machine instances, for example, <% fp '~/learn-chef/chef-server' %>.

<% command_snippet(page: current_page, path: 'mkdir-chef-server/mkdir-chef-server', features: :stdin) %>

Next, `cd` there.

<% command_snippet(page: current_page, path: 'mkdir-chef-server/cd-chef-server', features: :stdin) %>

Now add the following to a file named <% fp '~/learn-chef/chef-server/Vagrantfile' %>.

<% code_snippet(page: current_page, path: 'vagrant-up-chef-server/vagrantfile') %>

Finally, run `vagrant up` to bring up the virtual machine instances.

<% command_snippet(page: current_page, path: 'vagrant-up-chef-server/vagrant-up') %>

The process will take a few minutes. Here's an overview of what's happening.

* A Chef server and a node are provisioned with these characteristics:

  | Server      | Operating system | CPUs | Memory              | Hostname         | IP address |
  |-------------|------------------|------|---------------------|------------------|------------|
  | Chef server | Ubuntu 14.04     | 2    | 2GB                 | chef-server.test | 10.1.1.33  |
  | node        | CentOS 7.2       | 1    | 512MB (the default) | node1.test       | 10.1.1.34  |

  The IP addresses are allocated on the private network.

* The Chef server provisioning script:
  * configures the system to meet the [prerequisite system requirements](https://docs.chef.io/install_server.html#prerequisites).
  * [installs the Chef server package](https://docs.chef.io/install_server.html#standalone).
  * creates the `admin` [user](https://docs.chef.io/server_users.html) and the `4thcoffee` [organization](https://docs.chef.io/server_orgs.html).
  * copies files that you'll need later to <% fp '/vagrant/secrets' %>, which is [shared with the host machine](https://www.vagrantup.com/docs/synced-folders/).

[END_BOX]

[START_BOX]

## 3. Configure your workstation

<%= partial '../../shared/set-up-your-chef-server/knife_and_rsa_key' %>

To set up these files, start by creating the <% fp '~/learn-chef/.chef' %> directory.

<% command_snippet(page: current_page, path: 'mkdir-dot-chef/mkdir-dot-chef', features: :stdin) %>

Next, add the following to your `knife` configuration file, <% fp '~/learn-chef/.chef/knife.rb' %>

<% code_snippet(page: current_page, path: 'generate-knife-config/knife-rb') %>

Next, copy the RSA private key for the `admin` user from your Chef server. Recall that the Chef server provisioning script copies this file to a shared location you can easily access.

<% command_snippet(page: current_page, path: 'generate-knife-config/copy-admin-key', features: :stdin) %>

[The other versions of this tutorial](/tutorials/manage-a-node/rhel/) walk you though how you would set up these files in a more production-like environment.

Your RSA private key should resemble this one.

```bash
# ~
$ cat ~/learn-chef/.chef/admin.pem
-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAqJCxFv1BoqlTJeK5zTZ6vX6hvQuDzlaN0v+Fo5R2zobP72Ga
N8GUOhaYSM0Zkg+epchPS9JX81Euv847g662BBneuT4+W6ImqtHtoqB2iEw9vJbZ
UoIpYRzVCMLpCc3hf3St5FcIz/t55VIAOML8O33CZMkY3o+EUHQx65aI3IDFVcmz
xIFF+ziLbYc7Q1YHumXzv1pOP9o6QqFCcl/r4x5g9sj0eeYwYQBNppy9oELsrBuu
/SEKs41X+tm1nP/sDrxOeI5ybytcN3MZN0SjniMTP+7Knh6xnfeFbmaC9Hp/bpbd
lmaWv4iNJIhLBy/4LUkTh9jpC2knzJnq/bG4wQIDAQABAoIBAEbSXAUrrLr551xg
kO3+eL1LCgtSXjOAPCAtiWl8BBqrm4uY92F7rJpnSd40hgzPETnYGjDiFF+/eSPP
M0QVUJYShHhSBYMccqCMiQot3v9PARVOT8qRs28A3STMN3dkeK9761mPQX2Yy9Mk
i8FNcwpPwS/1KcTAibf/ycWQvrndlflL3KCl/Nnv//Das3dn41npkAB6sGySOPir
rajRuVR9REieRfx/vAGeOFkmWzuizBAxb+GXmYRy/Z+H+daEuqNd7QHAue4xg1s+
7yPB4V+EobpQVVssNkidX5SUcMvu+pU5l7OF9PP1zNMhvQItmhi77VXOj61fVeKP
JTaeHQECgYEA0lH6gVZRpmimoPJ5bNFeBKax/BzK1D7p7rD/z/i1qkiG3yCWYvQ/
1T4pl9kVndhubxaTUug/DcCpSp+va8vnQ3jS7LvDfS2SxNySH/g8XZ/EyO8Zvbfk
lqkpAdh3agKP310jB+dxqjbEwvdG9CdZyXK1ottXTzN07s0tCFcL7nECgYEAzS0X
OTs0FNSLc667Nq99NdcuoHkKsqxYn7zpoyaslqc4o9tABBXCimQJzIWbY3u477B/
1VrP8Ortepp0kev1ythYOGCAXBpukADLgw/1ygxVL51R+K6wbWDJyggMXvpOAhZX
WT0RiVeyOE2tyLERlIV4Q3t7lyXiLJ1irdhBN1ECgYA7FmT2aTXPNp95oCWU+M0d
KWffmIczUemO8ZMs7oa7LF0X2qPlcRFt62TsEEUOb3u3IfSJ2k28o1/sYyh5dHOo
dQ53jk2108asH/u9l5P+CaDTgrkMn9lMqoGmzxXdZpLdAeGRmuhIFdL5o1b/yP5k
piF5e33v9ljnriT0rt/fQQKBgGT9ZsrzzzXdoG2ublaFidnwerDeI1dk35JwqAd4
R8c3s/djOdVI6KK5ruEOenezNEo2dBWOR3/sAswwLmSM4kTfzDyjs0qib/1Nht6S
AodbHqr7IpfnVEviMjDRWVV+mtsIKCJynqkdk0mHYpzAG0khkRqWMzUonnUbWrD7
Gs6hAoGBAKrv2c3/42gSNu8MZFG8r8xmLehRg/Rj6nfFizTu9FH+ph8B4HgECBnV
1aHXvOsOaSDkjyPKa5hHCX145xWjme7blrSJfbsKiAAswSOJytc+PAPIULeocBr6
hW6cD7rMrt5D/6Ofxts8nQnNQ5Z3UJOtB6V3CFzlvw5oRXw1sIE0
-----END RSA PRIVATE KEY-----
```

Verify that your <% fp '.chef' %> directory contains your `knife` configuration file and RSA private key.

<% command_snippet(page: current_page, path: 'ls-dot-chef/ls-dot-chef') %>

You typically work with Chef server through its FQDN. Because your Chef server virtual machine is not backed by DNS, you need to first add an entry to your hosts file that maps your Chef server's hostname to its IP address. On a Mac OS or Linux workstation, you would run:

<% command_snippet(page: current_page, path: 'generate-knife-config/add-chef-server-to-hosts-file') %>

On Windows, you would run:

```ps
# ~\learn-chef
$ Add-Content C:\Windows\System32\drivers\etc\hosts "10.1.1.33 chef-server.test"
```

Finally, run these commands to fetch and verify the SSL certificate from your Chef server.

<% command_snippet(page: current_page, path: 'validate-ssl-cert/knife-ssl-fetch') %>

<% command_snippet(page: current_page, path: 'validate-ssl-cert/knife-ssl-check') %>

The certificate is added to your <% fp '~/learn-chef/.chef/trusted_certs' %> directory.

[END_BOX]

<% next_page(current_page) do %>

At this point, you have each of the three elements of a typical Chef setup &ndash; your workstation, a Chef server, and a node to manage.

Chef server gives you a persistent location to store your cookbooks and information about your nodes. The `knife` command enables you to communicate with the Chef server.

Next, you'll get a copy of the `learn_chef_httpd` cookbook that you wrote in the previous tutorial and upload it to your Chef server.

<% end %>
