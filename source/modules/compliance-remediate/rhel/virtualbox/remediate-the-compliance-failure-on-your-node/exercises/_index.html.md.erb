<h2>Exercises</h2>

<% exercise_question(<<-EOH
1. Why does the <b>Set SSH Protocol to 2</b> rule contain two <code>file</code> resources?
EOH
) %>

Recall that the rule looks like this:

<img src="/assets/images/compliance/ssh_protocol_2_rule.png"></img>

<% accordion('question1', 'Answer') do %>

<% markdown do %>

The **Set SSH Protocol to 2** rule ensures that the SSH configuration file explicitly sets the `Protocol` setting to 2. Because the configuration file might contains multiple `Protocol` settings, the rule ensures that each one specifies the recommended value.

The first `file` resource verifies that the SSH configuration file contains at least one occurence of the `Protocol` setting. The second `file` resource verifies that each occurence specifies 2 as its value.

If the rule contained only the second check, the rule would pass if the configuration file does not contain the `Protocol` setting. That's because the `each` part would return no results, so the `should eq "2"` part would not be checked.

<% end %>

<% end %>

<hr>

<% exercise_question(<<-EOH
2. If <code class="file-path">/etc/ssh/sshd_config</code> is modfied by some other process, what would you expect to happen the next time <code>chef-client</code> runs on your node?
EOH
) %>

<% accordion('question2', 'Answer') do %>

<% markdown do %>

Chef's test and repair approach would ensure that the file is restored to the desired state. If the file is already in the desired state, Chef does not modify it.

Configuration drift can bring your systems out of compliance. Running <code>chef-client</code> regularly or in response to a change helps ensure that your systems remain in compliance.

<% end %>

<% end %>

<hr>

<% exercise_question(<<-EOH
3. Repeat the remediation process to resolve a second compliance failure on your node.
EOH
) %>

You might consider remediating a failure that's part of your existing compliance requirements. For learning purposes, you can modify your existing <code>ssh</code> cookbook even if the compliance concern is not related to SSH.
<br>
<br>
<% accordion('question3', 'Answer') do %>

<%= partial '/modules/compliance-remediate/rhel/virtualbox/remediate-the-compliance-failure-on-your-node/exercises/answers/2' %>

<% end %>
